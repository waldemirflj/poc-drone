pipeline:
  npm-install:
    image: node:8.15.0-alpine
    commands:
      - cd api/
      - npm install
    when:
      branch: [ develop ]
      event: [ push ]

  npm-test:
    image: node:8.15.0-alpine
    commands:
      - cd api/
      - npm test
    when:
      branch: [ develop ]
      event: [ push ]
  
  # npm-version:
  #   image: node:8.15.0-alpine
  #   commands:
  #     - export VERSION=$(npm version patch)

  # foo:
  #   image: alpine
  #   commands:
  #     - touch hello.txt

  # bar:
  #   image: alpine
  #   commands:
  #     - ls hello.txt

  # git-version:
  #   image: plugins/git
  #   commands:
  #     - git --version

  # docker-registry-push:
  #   image: plugins/docker
  #   repo: waldemirflj/poc-drone
  #   secrets: [ docker_username, docker_password ]
  #   dockerfile: Dockerfile
  #   tags:
  #     - latest
  #     # - ${DRONE_COMMIT_SHA:0:8}
  #     # - ${DRONE_COMMIT_BRANCH}
  #   environment:
  #     - DOCKER_LAUNCH_DEBUG=true

  push-to-release:
    image: plugins/git-push
    remote_name: origin
    branch: release
    when:
      branch: [ develop ]
      event: [ push ]
      
        

